<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 <mapper namespace="com.groupware.mapper.ScheduleMapper">
 
 	<insert id="insertSchedule" parameterType="hashMap" >
		INSERT INTO schedule(key, title, cont, stdate, eddate, classify, priority, category, makepublic, s_id) 
		values(sc_seq.nextval,#{title},#{cont},#{stDate},#{edDate},#{classify},#{priority},#{category},#{makepublic},#{s_id})
 	</insert>
 	
 	<select id="selectSchedule" parameterType="hashMap" resultType="Schedule">
 		SELECT s.key key, s.title title, s.cont cont, s.stdate stdate, s.eddate eddate, 
 		s.classify classify, s.priority priority, s.category category, s.makepublic makepublic, s.s_id s_id, p.POSITION_NAME position, d.PARTNAME dept
 		FROM SCHEDULE s, EMPLOYEE e, POSITION p, DEPT d
 		WHERE s.S_ID = e.ID and p.POSITION_NO = e.POSITION_NO and e.DEPT_NO = d.DEPT_NO and s_id = #{s_id} and TO_CHAR(stdate, 'YYYY-MM') = #{stDate}
 	</select>
 	
 	<select id="editSelectSchedule" parameterType="int" resultType="Schedule">
 		SELECT key, title, cont, stdate, eddate, classify, priority, category, makepublic, s_id FROM Schedule 
 		WHERE key = #{key}
 	</select>
 	
 	<update id="editSchedule" parameterType="hashMap">
		update schedule set title='${title}', cont='${cont}', 
				stdate='${stDate}', eddate='${edDate}', CLASSIFY= ${classify}, 
				PRIORITY=${priority}, CATEGORY='${category}', MAKEPUBLIC= '${makepublic}' 
		where key=${key}
 	</update>
 	
 	<delete id="deleteSchedule" parameterType="int">
		delete from SCHEDULE where key=#{key}
 	</delete>
	
 </mapper>
  